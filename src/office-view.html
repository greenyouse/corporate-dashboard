<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/google-map/google-map.html">
<link rel="import" href="../bower_components/google-map/google-map-marker.html">
<link rel="import" href="report-data.html">

<dom-module id="office-view">

  <template>

    <style>
     :host {
         display: block;
         padding: 10px;
     }
     .card {
         box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
         padding: 1em;
         padding-bottom: 3em;
         border-radius: 5px;
         background-color: #fff;
     }

     h1 {
         font-size: 22px;
         margin: auto;
         color: #212121;
         text-align: center;
     }

     google-map {
         width: 60em;
         height: 40em;
         max-width: 100%;
         margin: auto;
     }
    </style>

    <div class="card">
      <h1>Office Locations</h1>
      <br>
      <google-map api-key='AIzaSyBkHxZZzchmvczNvUWMznd0DicwOWZ9dSE' fit-to-markers="true">
        <template is="dom-repeat" items="[[officeData]]" as="office">
          <google-map-marker latitude="[[office.coords.lat]]"
                             longitude="[[office.coords.lng]]"
                             title="[[office.office]]">
            <p>[[office.team]] Office: [[office.employees]] employees</p>
          </google-map-marker>
        </template>
      </google-map>
    </div>

    <report-data data="{{officeData}}" file-name="{{dataFile}}"></report-data>

  </template>

  <script>

    Polymer({

      is: 'office-view',

      properties: {
        officeData: Array,

        dataFile: {
          type: String,
          value: "/data/offices-1.json"
        }
      },

      // TODO: should abstract the file reloading into a behavior
      ready: function() {
        var _this1 = this;
        window.setInterval(function() {
          var files = ["/data/offices-1.json", "/data/offices-2.json"];
          _this1.dataFile == files[0] ? _this1.dataFile = files[1] : _this1.dataFile = files[0];
          console.log(_this1.dataFile);
        }, 5000);
      }
    });

  </script>

</dom-module>
